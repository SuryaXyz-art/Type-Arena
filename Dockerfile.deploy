FROM rust:1.79-bookworm

# Install dependencies
RUN apt-get update && apt-get install -y protobuf-compiler clang jq

# Install Linera CLI 0.15.8 (matching SDK)
RUN cargo install linera-service --version 0.15.8 --features storage-service

WORKDIR /app

# Copy deploy script
COPY deploy_docker.sh /usr/local/bin/deploy_docker.sh
RUN chmod +x /usr/local/bin/deploy_docker.sh

CMD ["deploy_docker.sh"]
